import matplotlib.pyplot as plt
import numpy as np
#import cv2 as cv

px=np.array([[ 0.7737313 ], [ 1.01758359], [-0.37149415], [ 1.70712527],
 [-1.48699013], [-2.07644819], [ 2.28298081], [-0.15987864],
 [ 1.7787048 ], [-1.99302454], [-1.32743482], [-2.21539252],
 [-0.81147619], [-1.4379046 ], [-1.01023527], [-1.97638684],
 [ 0.93710512], [ 0.71148664], [-1.20874865], [-0.55489419],
 [-0.65454354], [-1.9441292 ], [ 0.16592805], [ 1.69006497],
 [ 1.89887062]])
py=np.array([[ 0.87261153], [ 1.01150473], [ 1.09993991], [ 1.60523726],
 [-0.76060341], [-3.29933658], [ 3.99128231], [ 0.89114108],
 [ 1.30463954], [-3.09159127], [ 0.25876728], [-3.1132075 ],
 [ 0.80707797], [ 0.12324265], [ 0.42024265], [-2.7434859 ],
 [ 0.92747655], [ 0.89208245], [-0.07419363], [ 0.99353603],
 [ 1.03979391], [-2.31323434], [ 1.08030857], [ 1.99165034],
 [ 2.0520717 ]])
px=np.array([[ 0.04089332], [ 2.58409396], [ 1.24237068], [ 1.04536004],
 [-0.04227264], [-2.69192419], [ 1.175527  ], [-2.69316131],
 [-0.51366595], [ 1.41212956], [-0.11106249], [ 0.79163129],
 [ 1.45556992], [ 1.13537211], [-1.44111826], [-2.45774611],
 [ 2.61062717], [-0.59978171], [-1.00744064], [ 0.30554019],
 [-0.03238868], [-2.65542734], [-1.06315407], [-1.66457088],
 [-0.41673632]])
py=np.array([[0.87845676], [0.00183243], [0.46984604], [0.46399208],
 [1.11372435], [0.22565246], [0.44258258], [0.18696697],
 [0.89737243], [0.39796616], [1.25655353], [0.83685199],
 [0.44639918], [0.30241024], [0.41495768], [0.17644399],
 [0.2423662 ], [0.78507773], [0.51273715], [0.95802556],
 [0.83845453], [0.12083554], [0.61077806], [0.15243228],
 [0.97831423]])
N=px.shape[0]

# plot
fig, ax = plt.subplots()

ax.plot(px, py, 'x', markeredgewidth=2)
a=0.00300892
b=-0.10713608
c=-0.04251719
d=0.79955065

x = np.linspace(-5, 5, 100)
y = a*np.power(x,3)+b*np.power(x,2)+c*x+d
ax.plot(x, y)

ax.set(xlim=(-3.5, 3.5), ylim=(-5, 5))
ax.grid(visible=True)
plt.ion()
plt.show()
input()

grade=12
A=np.ones([N,1])
for k in range(1, grade):
    A=np.concatenate((np.power(px,k), A), axis=1)

Ainv=np.linalg.pinv(A)
w=np.matmul(Ainv, py)
print(w)

x = np.linspace(-5, 5, 100)
y=np.polyval(w, x)
est_y=a*px+b
lse=np.sqrt(np.sum((est_y-py)**2))
print('LSE: %0.3f' % lse)

ax.plot(x, y)
plt.show()
plt.pause(10.0)